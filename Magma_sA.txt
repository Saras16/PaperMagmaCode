clear;
q:= 12289;
R:=ResidueClassRing(q);
n:=1024;
p2:=Vector(R,n,[7820, 8785, 7104, 10700, 11159, 4866, 8319, 4838, 3500, 8233, 4368, 11272, 9739, 7146, 8468, 6567, 7489, 6325, 4251, 9139, 8689, 1827, 4817, 10147, 12162, 11961, 9883, 1183, 170, 1494, 5726, 1978, 166, 5461, 6375, 11218, 3981, 12255, 7591, 2412, 7744, 3498, 10701, 790, 2172, 10604, 5039, 4679, 10178, 2668, 9479, 1922, 12135, 11102, 2685, 885, 9762, 2745, 24, 2834, 3567, 11593, 5767, 6202, 2091, 2058, 2696, 12099, 5173, 931, 3491, 1381, 4126, 10425, 7739, 5610, 9724, 9377, 9443, 10283, 3684, 6046, 10167, 10496, 10198, 11596, 8107, 9432, 7872, 7600, 2439, 12077, 6128, 5149, 2740, 5792, 7794, 407, 3212, 7503, 280, 6248, 5692, 5259, 4859, 1498, 11052, 8120, 9518, 7497, 8714, 11559, 1000, 3815, 8619, 10734, 4087, 11434, 12278, 11606, 1267, 1995, 12228, 2955, 5522, 1418, 2255, 4804, 2180, 6134, 10687, 6785, 6354, 8746, 41, 4580, 4109, 917, 5940, 7078, 5668, 1590, 5678, 2904, 9486, 6288, 2624, 3091, 7395, 2535, 11661, 3163, 8788, 2590, 9408, 10444, 8256, 2325, 6329, 7625, 4392, 12043, 1554, 3316, 2401, 9517, 2611, 3752, 5948, 6962, 3959, 2559, 10198, 8643, 10207, 3762, 3600, 940, 8289, 10495, 5653, 7881, 2652, 12124, 995, 10731, 911, 9918, 10148, 4221, 4203, 4827, 1664, 4845, 2885, 9688, 1106, 9616, 9319, 9443, 11297, 12190, 6914, 11680, 345, 9808, 11529, 2515, 11361, 2273, 10681, 3567, 9973, 10242, 1519, 6762, 1119, 2093, 4923, 5353, 4598, 340, 4706, 9813, 4839, 12281, 11749, 9546, 9510, 609, 5498, 10831, 7619, 1145, 209, 10104, 1149, 7665, 775, 4643, 3834, 8644, 5315, 2348, 2677, 3679, 4578, 8674, 11003, 11357, 2912, 1402, 892, 9914, 410, 10587, 9517, 2832, 11032, 12107, 8290, 4263, 6447, 8021, 2789, 5989, 12165, 11203, 8899, 3054, 3529, 5242, 10235, 10050, 5398, 10201, 1156, 170, 10665, 3170, 11654, 10708, 3350, 4632, 4201, 6421, 12023, 160, 5653, 7706, 6451, 5704, 11372, 6881, 12213, 5748, 5993, 7462, 11761, 2248, 11750, 2432, 6115, 4071, 9403, 139, 9643, 7819, 5906, 4098, 7579, 5880, 10, 493, 8940, 840, 12019, 4380, 6844, 5181, 6962, 12210, 1723, 1927, 9681, 132, 11905, 8491, 6213, 4121, 1454, 1025, 8375, 2272, 5883, 10766, 1630, 33, 1789, 25, 1690, 5691, 3964, 6109, 5682, 7028, 1557, 437, 12186, 8877, 5985, 5173, 10434, 9609, 6896, 9749, 7606, 894, 2281, 1212, 209, 3540, 3577, 8362, 11910, 9268, 3922, 803, 5679, 5855, 9448, 6754, 2050, 9706, 8343, 9504, 10005, 8304, 8257, 11815, 2495, 1989, 10482, 11280, 8857, 2794, 1231, 6422, 326, 6416, 8425, 6336, 11592, 11425, 7146, 10727, 2870, 4243, 11796, 6395, 8570, 3067, 3107, 5523, 9510, 1820, 11117, 8959, 4614, 6986, 6211, 4785, 943, 6681, 6139, 7182, 543, 9002, 1943, 4722, 4372, 12245, 4550, 8657, 6546, 12, 10503, 5138, 2927, 3201, 3706, 1386, 2837, 4769, 2226, 9483, 8171, 8622, 5436, 4851, 4889, 1765, 4011, 5351, 7486, 10063, 174, 12142, 4530, 6266, 4252, 12160, 2060, 9801, 17, 7301, 7271, 6181, 2279, 7059, 3321, 11809, 11504, 11491, 12102, 7125, 10113, 1740, 2057, 7488, 1988, 2903, 11613, 6486, 6434, 2116, 6909, 1979, 1157, 4394, 11722, 1808, 1549, 11296, 11066, 1400, 10650, 1119, 6987, 670, 205, 5384, 12066, 4548, 491, 2459, 9035, 8792, 5700, 8575, 1586, 11683, 9663, 860, 12096, 9155, 12190, 2467, 6502, 1055, 10108, 9990, 7270, 12230, 3716, 6238, 2922, 5456, 5040, 11742, 5088, 4772, 11625, 10540, 6307, 1791, 8742, 5276, 9353, 2081, 8402, 12118, 10081, 4359, 7555, 10009, 3153, 3071, 2445, 3169, 1172, 7544, 3433, 2146, 9655, 5286, 6344, 2989, 1952, 6293, 10262, 12229, 9017, 6417, 6975, 10206, 10808, 1270, 478, 9667, 2550, 1350, 5494, 11041, 5392, 4716, 7398, 5835, 10986, 2079, 11463, 6264, 6589, 812, 2979, 658, 4502, 1609, 11679, 9501, 3303, 675, 4279, 2051, 8417, 7124, 9158, 7370, 10806, 758, 9629, 8879, 8237, 9015, 1561, 7982, 12214, 6756, 9583, 3860, 7488, 1325, 9153, 6179, 3126, 7768, 11846, 969, 8885, 3480, 11327, 2425, 8402, 10645, 3824, 3294, 3070, 11873, 4852, 3558, 3046, 4808, 9759, 9804, 2917, 2466, 10355, 10610, 1790, 8176, 980, 7311, 2213, 7201, 4612, 11179, 12195, 9168, 865, 2640, 8815, 863, 5913, 7859, 2101, 11837, 2582, 9958, 760, 4884, 8997, 8997, 3940, 1075, 11389, 5550, 11650, 1726, 5241, 8538, 7049, 11087, 4502, 1170, 10654, 1516, 7307, 4748, 5216, 10445, 5890, 5464, 8199, 3301, 11617, 11296, 2717, 113, 8084, 6497, 3221, 2812, 7652, 1277, 2533, 11685, 12172, 3808, 12193, 9871, 10799, 3273, 3325, 9412, 10021, 6696, 7048, 11735, 7492, 6737, 8180, 2609, 6641, 11343, 505, 8001, 2299, 1074, 730, 9309, 331, 8535, 10554, 9008, 5101, 141, 8427, 2573, 8150, 848, 1688, 11358, 7709, 4341, 4257, 7000, 6849, 10049, 9343, 6720, 7150, 3492, 7855, 5323, 11371, 5587, 9270, 3702, 5716, 4747, 7918, 5367, 3771, 1580, 6903, 7862, 1595, 8363, 7363, 3227, 2831, 1414, 3286, 4479, 9998, 9334, 11234, 7112, 10782, 7901, 12096, 364, 10881, 10700, 1041, 3447, 12166, 3753, 4264, 11402, 11172, 8924, 7918, 4056, 2024, 3135, 6679, 10771, 12210, 9640, 854, 6570, 3324, 3502, 541, 8331, 4663, 3179, 59, 3266, 7094, 2608, 1632, 3052, 10493, 9703, 6748, 5015, 8919, 3464, 7350, 2473, 6031, 4732, 1091, 3737, 8170, 5271, 873, 6722, 11298, 11286, 3610, 8715, 3135, 5032, 11774, 446, 8928, 1013, 3771, 139, 6199, 1324, 5777, 1243, 11001, 11839, 1547, 2721, 9791, 836, 8909, 2971, 6926, 5217, 6944, 6197, 618, 9583, 4963, 1651, 5797, 1841, 472, 8217, 10055, 8216, 9350, 3558, 9034, 6951, 6823, 11955, 11206, 2979, 10777, 6590, 5201, 2210, 5638, 1772, 5793, 9702, 9089, 4624, 11986, 5459, 7931, 5090, 11744, 10605, 2626, 6689, 10848, 1990, 6552, 10174, 5016, 6077, 7496, 953, 2107, 7180, 4702, 10778, 2172, 11200, 6557, 6646, 4296, 2158, 5135, 2755, 9861, 151, 9371, 240, 2117, 4003, 491, 6646, 1319, 8655, 3638, 1583, 11016, 12097, 3057, 6204, 11817, 3313, 974, 6519, 9669, 5309, 8283, 8423, 2319, 10686, 8814, 357, 11485, 430, 10025, 10901, 5350, 3626, 1401, 2614, 1114, 7663, 10347, 2742, 107, 12079, 484, 5959, 11572, 10000, 10712, 11516, 8764, 7095, 10253, 11696, 5315, 11910, 3690, 9802, 3789, 7886, 3534, 4739, 205, 3037, 764, 8222, 3341, 7209, 2827, 11747, 632, 7091, 4983, 5766, 2148, 2286, 3174, 3252, 11786, 5538, 2270, 1678, 2560, 7211, 8491, 7051, 10529, 10379, 2507, 4541, 11555, 1023, 408, 10879, 8143, 4084, 9849, 517, 9360, 11995, 8862, 8914, 12227, 3809, 10092, 4190, 4808, 5199, 4176, 1756, 12204, 6287, 8204, 8292, 6407, 10458, 6376, 9838, 6370, 5540, 5666, 8064, 1839, 1495, 2055, 10366, 5309, 9063, 10856, 4891, 868, 5783]);
kkeyt:=Vector(R,1,[0]);

p2m:=Matrix(R,n,n,[]);
p2mt:=Matrix(R,n,n,[]);
for i in [1..n] do
	p2m[i][1]:= p2[i];
end for;
		
//set the other columns as rotations of 1st column
for j in [2..n] do
	for i in [1..n] do
		ind:=(i + n - 2) mod n;
		if i eq 1 then
			p2m[i][j]:= -p2m[ind+1][j-1];
		else
			p2m[i][j]:= p2m[ind+1][j-1];
		end if;
	end for;
end for;
p2mt:=Matrix(R,1,n,[p2m[n]]);
skps,skp:=Solution(Transpose(p2mt),kkeyt);

//chk
skpm:=Matrix(R,1,n,[skps]);
p2m*Transpose(skpm);

skpBasis:=Basis(skp);
d:=Dimension(skp);

//create matrix with basis and qI
Lm:=Matrix(Integers(),d+n,n,[]);
for i in [1..d] do
  for j in [1..n] do
    Lm[i][j]:=skpBasis[i][j];
  end for;
end for;

for i in [d+1..d+n] do
  Lm[i][i-n+1]:=q;
end for;

LLLmat:=LLL(Lm);
LLLmatr:=Matrix(R,1,n,[LLLmat[1]]);
p2m*Transpose(LLLmatr);